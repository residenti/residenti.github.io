---
layout: post
title:  "[AWS] EC2インスタンスを停止しているのに課金されていて慌てた話"
date:   2019-10-14 02:00:00 +0900
categories: aws
---

以前、AWSの学習としてVPCにプライベートとパブリックサブネットを作成し、前者をDBサーバーとしてMySQLをインストールし、後者をWebサーバー(Apache)としてWordPressをインストールしてブログ環境を構築した。
これが1ヶ月くらい前？の話で、構築後はブログは全く利用せずという感じ。
そして、最近AWSから請求メールが送られてきたので、確認すると1,700円も課金されていた。AWSコンソールで何に課金されているのか見たところEC2に費用が掛かっていたので、とりあえず、EC2インスタンスを停止しとくことに。
しかし、次の日に確認するとまた上がっていた。
インスタンスを停止しているのになぜEBSに課金されるのだろうと調べたところ、公式の質問コーナーに答えが有った。

> EBS ストレージはアカウントでプロビジョニングしたストレージ量に応じて「ギガバイト-月」単位で課金されます。
> EC2 インスタンスで料金が発生するのはそれを起動している間だけですが、インスタンスに接続されている EBS ボリュームの場合、インスタンスを停止したとしても、情報の保持と料金の発生は継続されます。
> EBS の課金についての詳細は、「Amazon EBS 料金表」を参照してください。
> EBS 関連の課金を停止するには、要らなくなった EBS ボリューム と EBS スナップショット を削除します。
> EBS スナップショットはアクティブな EBS ボリュームよりも安い料金で課金されます。
> 後からの使用に備えて EBS に格納されている情報は保持したまま、EBS 課金を最小限にするには、バックアップ用にボリュームのスナップショットを作成してから、アクティブなボリュームを削除します。
> 後でスナップショットに格納していた情報が必要になった場合、スナップショットから EBS ボリュームを復元すれば、インフラストラクチャ内で使用することができます。

とのことだったので、スナップショットとにしてどのくらい値段が変わるか試してみました。
手順は、インスタンスからEBSボリュームをデタッチし、スナップショットを作成してから削除した。

数日後に、課金金額を確認すると確かにいくらかさがってはいたが、そもそも使っていないので、スナップショットも削除し完全に課金を止めることにした。

# 参考サイト

・[公式 | インスタンスがすべて停止しているのに EBS に課金されるのはなぜですか。](https://aws.amazon.com/jp/premiumsupport/knowledge-center/ebs-charge-stopped-instance/)
・[【AWS】（番外編）EBSの無料枠が知らぬ間に消費されている！？](https://www.wantanblog.com/entry/2019/08/12/002745)
・[インスタンスを削除する - インスタンスのターミネイト(終了) (Amazon AWSの使い方 Tips)](https://www.ipentec.com/document/amazon-ec2-terminate-instance)
